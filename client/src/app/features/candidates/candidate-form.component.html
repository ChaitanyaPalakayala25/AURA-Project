<div class="form-container">
    <app-progress-bar [currentStep]="getCurrentStep()"></app-progress-bar>

    <form [formGroup]="candidateForm" (ngSubmit)="onSubmit()">
        <mat-card>
            <mat-card-header>
                <mat-card-title>{{ isEditMode ? 'Edit' : 'Add' }} Candidate Onboarding</mat-card-title>
            </mat-card-header>

            <mat-tab-group animationDuration="500ms">

                <!-- Tab 1: General Info -->
                <mat-tab label="General Info">
                    <div class="tab-content">
                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Candidate Name (Title)</mat-label>
                                <input matInput formControlName="title" placeholder="Full Name">
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                                <mat-label>Status</mat-label>
                                <mat-select formControlName="status">
                                    <mat-option value="In-Process">In-Process</mat-option>
                                    <mat-option value="Completed">Completed</mat-option>
                                    <mat-option value="Archived">Archived</mat-option>
                                    <mat-option value="Bench">Bench</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Navitas Email ID</mat-label>
                                <input matInput formControlName="navitasEmailId" placeholder="example@navitas.com">
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                                <mat-label>Personal Email ID</mat-label>
                                <input matInput formControlName="personalEmailId" placeholder="personal@email.com">
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Contact Details</mat-label>
                                <input matInput formControlName="contactDetails" placeholder="Phone Number">
                            </mat-form-field>

                            <mat-form-field appearance="outline">
                                <mat-label>Designation</mat-label>
                                <input matInput formControlName="candidateDesignation" placeholder="Job Title">
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Location</mat-label>
                                <input matInput formControlName="location">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Region</mat-label>
                                <input matInput formControlName="region">
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Experience (Years)</mat-label>
                                <input matInput type="number" formControlName="experienceInYears">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Work Authorization</mat-label>
                                <input matInput formControlName="workAuthorization">
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Employee Type</mat-label>
                                <mat-select formControlName="employeeType">
                                    <mat-option value="FTE">Full Time (FTE)</mat-option>
                                    <mat-option value="Contractor">Contractor (C2C/W2)</mat-option>
                                    <mat-option value="Internal">Internal Transfer</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="row" *ngIf="candidateForm.get('employeeType')?.value === 'Contractor'">
                            <mat-form-field appearance="outline">
                                <mat-label>Vendor Name</mat-label>
                                <input matInput formControlName="vendorName" placeholder="Agency Name">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Contract Duration</mat-label>
                                <input matInput formControlName="contractDuration" placeholder="e.g. 6 Months">
                            </mat-form-field>
                        </div>
                    </div>
                </mat-tab>

                <!-- Tab 2: Project Details -->
                <mat-tab label="Project Details">
                    <div class="tab-content">
                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Project Name</mat-label>
                                <input matInput formControlName="projectName">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Project Start Date</mat-label>
                                <input matInput [matDatepicker]="picker" formControlName="projectStartDate">
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Project Duration</mat-label>
                                <input matInput formControlName="projectDuration">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Bill Rate</mat-label>
                                <input matInput type="number" formControlName="billRate">
                            </mat-form-field>
                        </div>

                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Recruiter Name</mat-label>
                                <input matInput formControlName="recruiterName">
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Reporting Manager</mat-label>
                                <input matInput formControlName="reportingManager">
                            </mat-form-field>
                        </div>
                    </div>
                </mat-tab>

                <!-- Tab 3: Team Checklists -->
                <mat-tab label="Team Checklists">
                    <div class="tab-content">
                        <div class="checklist-section">
                            <h3><mat-icon>assignment</mat-icon> IT Checklist</h3>
                            <div class="checkbox-grid">
                                <mat-checkbox formControlName="vpnAccess">VPN Access</mat-checkbox>
                                <mat-checkbox formControlName="sharedFolderAccess">Shared Folder</mat-checkbox>
                                <mat-checkbox formControlName="sharepointAccess">SharePoint</mat-checkbox>
                                <mat-checkbox formControlName="laptopIssued">Laptop Issued</mat-checkbox>
                                <mat-checkbox formControlName="distroEmailCreated">Distro Email</mat-checkbox>
                            </div>
                            <mat-form-field appearance="outline" class="full-width">
                                <mat-label>Laptop Serial Number</mat-label>
                                <input matInput formControlName="laptopSerialNumber">
                            </mat-form-field>
                        </div>

                        <div class="checklist-section">
                            <h3><mat-icon>people</mat-icon> HR & Recruiter Checklist</h3>
                            <div class="checkbox-grid">
                                <mat-checkbox formControlName="resumeCollection">Resume Collected</mat-checkbox>
                                <mat-checkbox formControlName="passportCopy">Passport Copy</mat-checkbox>
                                <mat-checkbox formControlName="h1bApprovalCopy">H1B Approval</mat-checkbox>
                                <mat-checkbox formControlName="payrollSetupStatus">Payroll Setup</mat-checkbox>
                                <mat-checkbox formControlName="orientationCompleted">Orientation</mat-checkbox>
                            </div>
                        </div>

                        <div class="checklist-section">
                            <h3><mat-icon>verified_user</mat-icon> Audit & Compliance</h3>
                            <div class="checkbox-grid">
                                <mat-checkbox formControlName="msaSigned">MSA Signed</mat-checkbox>
                                <mat-checkbox formControlName="workOrderReceived">Work Order</mat-checkbox>
                                <mat-checkbox formControlName="coiReceived">COI Received</mat-checkbox>
                                <mat-checkbox formControlName="vendorSetupApproval">Vendor Setup Approval</mat-checkbox>
                            </div>
                        </div>
                    </div>
                </mat-tab>

                <!-- Tab 4: Timestamps -->
                <mat-tab label="Workflow Timestamps">
                    <div class="tab-content">
                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Recruiter Completed</mat-label>
                                <input matInput [matDatepicker]="recPicker" formControlName="recruiterTimestamp">
                                <mat-datepicker-toggle matSuffix [for]="recPicker"></mat-datepicker-toggle>
                                <mat-datepicker #recPicker></mat-datepicker>
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>HR Completed</mat-label>
                                <input matInput [matDatepicker]="hrPicker" formControlName="hrTimestamp">
                                <mat-datepicker-toggle matSuffix [for]="hrPicker"></mat-datepicker-toggle>
                                <mat-datepicker #hrPicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>IT Completed</mat-label>
                                <input matInput [matDatepicker]="itPicker" formControlName="itTimestamp">
                                <mat-datepicker-toggle matSuffix [for]="itPicker"></mat-datepicker-toggle>
                                <mat-datepicker #itPicker></mat-datepicker>
                            </mat-form-field>
                            <mat-form-field appearance="outline">
                                <mat-label>Manager Approved</mat-label>
                                <input matInput [matDatepicker]="manPicker" formControlName="managerTimestamp">
                                <mat-datepicker-toggle matSuffix [for]="manPicker"></mat-datepicker-toggle>
                                <mat-datepicker #manPicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="row">
                            <mat-form-field appearance="outline">
                                <mat-label>Audit Completed</mat-label>
                                <input matInput [matDatepicker]="auditPicker" formControlName="auditTimestamp">
                                <mat-datepicker-toggle matSuffix [for]="auditPicker"></mat-datepicker-toggle>
                                <mat-datepicker #auditPicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                    </div>
                </mat-tab>
            </mat-tab-group>

            <mat-card-actions align="end">
                <button mat-button type="button" (click)="cancel()">Cancel</button>
                <button mat-raised-button color="primary" type="submit" [disabled]="candidateForm.invalid">
                    {{ isEditMode ? 'Update' : 'Create' }}
                </button>
            </mat-card-actions>
        </mat-card>
    </form>
</div>